<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Etaria.net ‚Äì Masterplan</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Outfit:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
<style>
:root{--bg:#060809;--surface:#0b0d11;--card:#0f1218;--border:#1a2030;--border-h:#253045;--amber:#f5a623;--amber-g:linear-gradient(135deg,#f5a623,#ff6b35);--red:#ef4444;--blue:#3b82f6;--green:#10b981;--purple:#a855f7;--cyan:#06b6d4;--text:#e2e8f4;--text-m:#7d8da4;--text-d:#3e506a;--radius:10px;--glow:0 0 40px rgba(245,166,35,.06)}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{background:var(--bg);color:var(--text);font-family:'Outfit',sans-serif;line-height:1.6;min-height:100vh}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--border-h);border-radius:3px}
body::before{content:'';position:fixed;inset:0;z-index:9999;pointer-events:none;opacity:.035;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E")}
.login-overlay{position:fixed;inset:0;z-index:10000;background:rgba(6,8,9,.92);backdrop-filter:blur(20px);display:flex;align-items:center;justify-content:center;opacity:1;transition:opacity .4s}.login-overlay.hidden{opacity:0;pointer-events:none}
.login-box{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:2.5rem;width:380px;max-width:90vw;text-align:center;position:relative;box-shadow:var(--glow),0 24px 80px rgba(0,0,0,.5)}.login-box::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--amber-g);border-radius:16px 16px 0 0}
.login-logo{font-family:'Space Mono',monospace;font-size:1.6rem;font-weight:700;background:var(--amber-g);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:.3rem}.login-sub{color:var(--text-d);font-size:.8rem;margin-bottom:1.8rem}
.login-tabs{display:flex;margin-bottom:1.5rem;background:var(--surface);border-radius:8px;padding:3px}.login-tab{flex:1;padding:.6rem;font-family:'Outfit',sans-serif;font-size:.78rem;font-weight:600;border:none;background:none;color:var(--text-d);cursor:pointer;border-radius:6px;transition:.25s}.login-tab.active{background:var(--card);color:var(--amber);box-shadow:0 2px 8px rgba(0,0,0,.3)}
.login-field{margin-bottom:.8rem}.login-field input{width:100%;padding:.75rem 1rem;background:var(--surface);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:'Space Mono',monospace;font-size:.8rem;outline:none;transition:.25s}.login-field input:focus{border-color:var(--amber);box-shadow:0 0 0 3px rgba(245,166,35,.1)}.login-field input::placeholder{color:var(--text-d)}
.login-btn{width:100%;padding:.85rem;background:var(--amber-g);border:none;border-radius:8px;color:#000;font-family:'Outfit',sans-serif;font-size:.85rem;font-weight:700;cursor:pointer;margin-top:.5rem;transition:.25s}.login-btn:hover{transform:translateY(-1px);box-shadow:0 8px 30px rgba(245,166,35,.25)}.login-btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
.login-error{color:var(--red);font-size:.72rem;margin-top:.6rem;min-height:1rem}.guest-link{color:var(--text-d);font-size:.72rem;margin-top:1rem;cursor:pointer;transition:.2s}.guest-link:hover{color:var(--text-m)}
.topbar{position:fixed;top:0;left:0;right:0;z-index:500;background:rgba(6,8,9,.85);backdrop-filter:blur(16px);border-bottom:1px solid var(--border);padding:0 1.5rem;height:52px;display:flex;align-items:center;justify-content:space-between}.topbar-left{display:flex;align-items:center;gap:.75rem}.topbar-logo{font-family:'Space Mono',monospace;font-size:.95rem;font-weight:700;background:var(--amber-g);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.topbar-badge{font-family:'Space Mono',monospace;font-size:.55rem;letter-spacing:.1em;text-transform:uppercase;padding:.2em .6em;border-radius:4px;border:1px solid}.badge-admin{color:var(--amber);border-color:rgba(245,166,35,.3);background:rgba(245,166,35,.08)}.badge-viewer{color:var(--text-d);border-color:var(--border);background:var(--surface)}
.topbar-right{display:flex;align-items:center;gap:.75rem}.topbar-user{font-size:.75rem;color:var(--text-m)}.topbar-user strong{color:var(--text)}
.btn-sm{font-family:'Outfit',sans-serif;font-size:.7rem;font-weight:600;padding:.4rem .8rem;border-radius:6px;border:1px solid var(--border);background:var(--surface);color:var(--text-m);cursor:pointer;transition:.2s}.btn-sm:hover{border-color:var(--border-h);color:var(--text)}
.edit-mode-bar{position:fixed;bottom:0;left:0;right:0;z-index:500;background:rgba(245,166,35,.1);border-top:2px solid var(--amber);backdrop-filter:blur(10px);padding:.6rem 1.5rem;display:none;align-items:center;justify-content:center;gap:1rem}.edit-mode-bar.show{display:flex}.edit-mode-bar span{font-family:'Space Mono',monospace;font-size:.72rem;color:var(--amber);font-weight:700}
.edit-save-btn{font-family:'Outfit',sans-serif;font-size:.72rem;font-weight:600;padding:.35rem 1rem;border-radius:6px;border:none;background:var(--amber-g);color:#000;cursor:pointer}.edit-cancel-btn{font-family:'Outfit',sans-serif;font-size:.72rem;font-weight:600;padding:.35rem 1rem;border-radius:6px;border:1px solid var(--border);background:var(--surface);color:var(--text-m);cursor:pointer}
[data-editable]{position:relative;transition:.2s}body.admin-mode [data-editable]{cursor:text;border-radius:4px}body.admin-mode [data-editable]:hover{outline:1px dashed rgba(245,166,35,.35);outline-offset:3px}body.admin-mode [data-editable]:focus{outline:2px solid var(--amber);outline-offset:3px;background:rgba(245,166,35,.04)}
.app{max-width:1140px;margin:0 auto;padding:72px 1.5rem 5rem}
.hero{text-align:center;padding:3rem 0 2rem;position:relative}.hero::after{content:'';position:absolute;bottom:0;left:10%;right:10%;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent)}
.hero-tag{font-family:'Space Mono',monospace;font-size:.6rem;letter-spacing:.2em;text-transform:uppercase;color:var(--amber);border:1px solid rgba(245,166,35,.2);padding:.35em 1.2em;border-radius:100px;display:inline-block;margin-bottom:1.2rem;background:rgba(245,166,35,.04)}
.hero h1{font-size:clamp(2rem,5vw,3.2rem);font-weight:900;letter-spacing:-.04em;background:linear-gradient(135deg,#fff 20%,var(--amber) 80%,#ff6b35);-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1.15}.hero-desc{color:var(--text-d);font-size:.85rem;margin-top:.6rem}
.nav-wrap{position:sticky;top:52px;z-index:100;background:rgba(6,8,9,.88);backdrop-filter:blur(14px);border-bottom:1px solid var(--border);margin:0 -1.5rem;padding:0 1.5rem}.nav-inner{display:flex;overflow-x:auto;scrollbar-width:none}.nav-inner::-webkit-scrollbar{display:none}
.nav-btn{font-family:'Outfit',sans-serif;font-size:.75rem;font-weight:600;color:var(--text-d);background:none;border:none;padding:.9rem 1.1rem;cursor:pointer;white-space:nowrap;border-bottom:2px solid transparent;transition:.25s;display:flex;align-items:center;gap:.4rem}.nav-btn:hover{color:var(--text-m)}.nav-btn.active{color:var(--amber);border-bottom-color:var(--amber)}
.search-wrap{margin:1rem 0 .5rem;position:relative}.search-wrap input{width:100%;padding:.7rem 1rem .7rem 2.5rem;background:var(--card);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:'Outfit',sans-serif;font-size:.8rem;outline:none;transition:.25s}.search-wrap input:focus{border-color:var(--amber)}.search-wrap input::placeholder{color:var(--text-d)}.search-wrap::before{content:'üîç';position:absolute;left:.85rem;top:50%;transform:translateY(-50%);font-size:.8rem;pointer-events:none}
.prog-wrap{margin:1.5rem 0;background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem 1.4rem;box-shadow:var(--glow)}.prog-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:.6rem}.prog-top h3{font-size:.82rem;font-weight:700}.prog-pct{font-family:'Space Mono',monospace;font-size:.85rem;color:var(--amber);font-weight:700}
.prog-bar{height:6px;background:var(--surface);border-radius:3px;overflow:hidden}.prog-fill{height:100%;background:var(--amber-g);border-radius:3px;transition:width .6s;width:0%;position:relative}.prog-fill::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.15),transparent);animation:shimmer 2.5s infinite}@keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
.prog-stats{display:flex;gap:1.2rem;margin-top:.5rem;font-family:'Space Mono',monospace;font-size:.6rem;color:var(--text-d)}
.sec{margin-top:2rem;display:none;animation:fadeUp .35s ease}.sec.vis{display:block}@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}
.sec-head{display:flex;align-items:center;gap:.7rem;margin-bottom:1.3rem}.sec-ico{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:1.1rem;flex-shrink:0}.sec-head h2{font-size:1.15rem;font-weight:800}.sec-cnt{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--text-d);background:var(--surface);border:1px solid var(--border);padding:.15em .6em;border-radius:4px;margin-left:auto}.sec-desc{color:var(--text-m);font-size:.82rem;margin:-1rem 0 1.3rem;line-height:1.65}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(330px,1fr));gap:.75rem}.grid-sm{grid-template-columns:repeat(auto-fill,minmax(270px,1fr))}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;position:relative;overflow:hidden;transition:.3s}.card:hover{border-color:var(--border-h);transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,.3)}.card .accent-bar{position:absolute;top:0;left:0;right:0;height:2px}
.card-head{display:flex;align-items:center;gap:.6rem;margin-bottom:.5rem}.card-emoji{font-size:1.2rem}.card-meta{display:flex;flex-direction:column}.card-cat{font-family:'Space Mono',monospace;font-size:.52rem;letter-spacing:.15em;text-transform:uppercase;color:var(--text-d)}.card h4{font-size:.9rem;font-weight:700}.card p{font-size:.78rem;color:var(--text-m);line-height:1.65}.card-detail{font-size:.72rem;color:var(--text-m);line-height:1.6;margin-top:.4rem}.card .tags{display:flex;gap:.35rem;flex-wrap:wrap;margin-top:.65rem}
.pill{font-family:'Space Mono',monospace;font-size:.55rem;padding:.18em .55em;border-radius:4px;border:1px solid;white-space:nowrap}
.badge-live,.badge-partial,.badge-missing{font-family:'Space Mono',monospace;font-size:.5rem;padding:.12em .5em;border-radius:4px;margin-left:.35rem}.badge-live{background:rgba(16,185,129,.12);color:var(--green);border:1px solid rgba(16,185,129,.25)}.badge-partial{background:rgba(245,166,35,.1);color:var(--amber);border:1px solid rgba(245,166,35,.25)}.badge-missing{background:rgba(239,68,68,.1);color:var(--red);border:1px solid rgba(239,68,68,.25)}
.status-row{display:flex;align-items:center;justify-content:space-between;margin-top:.8rem;padding-top:.7rem;border-top:1px solid var(--border);gap:.5rem;flex-wrap:wrap}.prio-btns{display:flex;gap:.3rem}
.pbtn{font-family:'Space Mono',monospace;font-size:.58rem;padding:.28em .65em;border:1px solid var(--border);border-radius:5px;background:none;color:var(--text-d);cursor:pointer;transition:.2s}.pbtn:hover{border-color:var(--border-h);color:var(--text-m)}.pbtn.s-h{background:rgba(16,185,129,.1);border-color:var(--green);color:var(--green)}.pbtn.s-m{background:rgba(245,166,35,.1);border-color:var(--amber);color:var(--amber)}.pbtn.s-l{background:rgba(239,68,68,.1);border-color:var(--red);color:var(--red)}
.chk{display:flex;align-items:center;gap:.4rem;font-family:'Space Mono',monospace;font-size:.58rem;color:var(--text-d);cursor:pointer;user-select:none}.chk .box{width:16px;height:16px;border:1.5px solid var(--border-h);border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:.55rem;transition:.2s;flex-shrink:0}.chk.on .box{background:var(--green);border-color:var(--green);color:#000}
.tl{position:relative;padding-left:2.4rem}.tl::before{content:'';position:absolute;left:11px;top:0;bottom:0;width:2px;background:linear-gradient(180deg,var(--amber),var(--border))}.ph{position:relative;margin-bottom:1.1rem}.ph .dot{position:absolute;left:-2.4rem;top:1.4rem;width:24px;height:24px;border-radius:50%;border:2px solid var(--border);background:var(--bg);display:flex;align-items:center;justify-content:center;font-family:'Space Mono',monospace;font-size:.55rem;font-weight:700;z-index:1;transition:.3s}.ph.done .dot{background:var(--green);border-color:var(--green);color:#000}.ph .ptop{display:flex;justify-content:space-between;align-items:center;gap:.5rem;margin-bottom:.4rem}.ph .time-badge{font-family:'Space Mono',monospace;font-size:.58rem;color:var(--text-d);background:var(--surface);border:1px solid var(--border);padding:.18em .55em;border-radius:4px}.ph .goal-text{font-size:.74rem;color:var(--amber);font-weight:600;margin-bottom:.4rem}
.cklist{margin-top:.65rem;display:flex;flex-direction:column;gap:.3rem}.ck{display:flex;align-items:center;gap:.5rem;font-size:.76rem;color:var(--text-m);cursor:pointer;padding:.3rem .4rem;border-radius:6px;user-select:none;transition:.2s}.ck:hover{background:rgba(255,255,255,.02);color:var(--text)}.ck.on{color:var(--text-d);text-decoration:line-through}.ck .box{width:17px;height:17px;border:1.5px solid var(--border-h);border-radius:4px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:.55rem;transition:.2s}.ck.on .box{background:var(--green);border-color:var(--green);color:#000}
.syn{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1.1rem 1.2rem;transition:.25s}.syn:hover{border-color:var(--border-h);transform:translateY(-1px)}.syn .syn-title{font-size:.82rem;font-weight:700;margin-bottom:.35rem;display:flex;align-items:center;gap:.45rem}.syn p{font-size:.75rem;color:var(--text-m);line-height:1.6}
.tip{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem 1.3rem;transition:.25s}.tip:hover{border-color:var(--border-h);transform:translateY(-1px)}.tip-head{font-size:.85rem;font-weight:700;margin-bottom:.4rem;display:flex;align-items:center;gap:.5rem}.tip-num{font-family:'Space Mono',monospace;font-size:.55rem;color:var(--text-d);background:var(--surface);border:1px solid var(--border);width:22px;height:22px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0}.tip p{font-size:.76rem;color:var(--text-m);line-height:1.65}.tip-action{margin-top:.55rem;font-size:.74rem;color:var(--green);font-weight:600}
.psycho-card .problem-label{color:var(--red);font-weight:600;font-size:.74rem}.psycho-card .fix-label{color:var(--green);font-weight:600;font-size:.74rem;margin-top:.6rem;display:block}
.quick-stats{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:.5rem;margin-bottom:1.5rem}.qstat{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:.8rem 1rem;text-align:center}.qstat-val{font-family:'Space Mono',monospace;font-size:1.3rem;font-weight:700}.qstat-label{font-size:.65rem;color:var(--text-d);margin-top:.15rem}
.c-a{color:var(--amber)}.c-r{color:var(--red)}.c-b{color:var(--blue)}.c-g{color:var(--green)}.c-p{color:var(--purple)}.c-c{color:var(--cyan)}.bg-a{background:var(--amber)}.bg-r{background:var(--red)}.bg-b{background:var(--blue)}.bg-g{background:var(--green)}.bg-p{background:var(--purple)}.bg-c{background:var(--cyan)}
.i-a{background:rgba(245,166,35,.12);color:var(--amber)}.i-r{background:rgba(239,68,68,.1);color:var(--red)}.i-b{background:rgba(59,130,246,.1);color:var(--blue)}.i-g{background:rgba(16,185,129,.1);color:var(--green)}.i-p{background:rgba(168,85,247,.1);color:var(--purple)}.i-c{background:rgba(6,182,212,.1);color:var(--cyan)}
.t-a{color:var(--amber);border-color:rgba(245,166,35,.25);background:rgba(245,166,35,.08)}.t-r{color:var(--red);border-color:rgba(239,68,68,.25);background:rgba(239,68,68,.08)}.t-b{color:var(--blue);border-color:rgba(59,130,246,.25);background:rgba(59,130,246,.08)}.t-g{color:var(--green);border-color:rgba(16,185,129,.25);background:rgba(16,185,129,.08)}.t-p{color:var(--purple);border-color:rgba(168,85,247,.25);background:rgba(168,85,247,.08)}.t-c{color:var(--cyan);border-color:rgba(6,182,212,.25);background:rgba(6,182,212,.08)}
.toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--green);color:#000;font-family:'Space Mono',monospace;font-size:.72rem;font-weight:700;padding:.6rem 1.5rem;border-radius:8px;opacity:0;transition:.3s;z-index:600;pointer-events:none}.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}.toast.error{background:var(--red);color:#fff}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid var(--text-d);border-top-color:var(--amber);border-radius:50%;animation:spin .6s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}
.online-dot{width:8px;height:8px;border-radius:50%;background:var(--green);display:inline-block;margin-right:.3rem;animation:pulse 2s infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
@media(max-width:700px){.app{padding:60px .8rem 5rem}.grid,.grid-sm{grid-template-columns:1fr}.nav-btn{padding:.75rem .65rem;font-size:.7rem}.hero h1{font-size:1.7rem}.topbar{padding:0 .8rem}.quick-stats{grid-template-columns:repeat(2,1fr)}.status-row{flex-direction:column;align-items:flex-start}.login-box{padding:1.8rem}}
</style>
</head>
<body>
<div class="login-overlay" id="loginOverlay"><div class="login-box"><div class="login-logo">ETARIA.NET</div><div class="login-sub">Masterplan Dashboard</div><div class="login-tabs"><button class="login-tab active" onclick="switchLoginTab('admin')">üîë Admin</button><button class="login-tab" onclick="switchLoginTab('guest')">üëÅÔ∏è Besucher</button></div><div id="loginForm"><div class="login-field"><input type="email" id="loginUser" placeholder="E-Mail" autocomplete="email"></div><div class="login-field"><input type="password" id="loginPass" placeholder="Passwort" autocomplete="current-password"></div><button class="login-btn" id="loginBtn" onclick="doLogin()">Anmelden</button><div class="login-error" id="loginError"></div></div><div id="guestForm" style="display:none"><div class="login-field"><input type="text" id="guestName" placeholder="Dein Name (optional)" autocomplete="off"></div><button class="login-btn" style="background:var(--surface);color:var(--text);border:1px solid var(--border)" onclick="doGuest()">Als Besucher eintreten</button></div><div class="guest-link" id="guestLink" onclick="switchLoginTab('guest')">Oder als Besucher ansehen ‚Üí</div></div></div>
<div class="topbar" id="topbar" style="display:none"><div class="topbar-left"><span class="topbar-logo">ETARIA</span><span class="topbar-badge" id="roleBadge">ADMIN</span><span id="syncStatus"></span></div><div class="topbar-right"><span class="topbar-user" id="userDisplay"></span><button class="btn-sm" id="editToggle" style="display:none" onclick="toggleEditMode()">‚úèÔ∏è Bearbeiten</button><button class="btn-sm" onclick="doLogout()">Abmelden</button></div></div>
<div class="edit-mode-bar" id="editBar"><span>‚úèÔ∏è BEARBEITUNGSMODUS</span><button class="edit-save-btn" onclick="saveEdits()">üíæ Speichern</button><button class="edit-cancel-btn" onclick="cancelEdits()">‚úó Abbrechen</button></div>
<div class="toast" id="toast"></div>
<div class="app" id="app" style="display:none">
<header class="hero"><div class="hero-tag" data-editable="hero-tag">Paper 1.21+ ¬∑ 16 Custom Plugins</div><h1 data-editable="hero-title">Etaria.net Masterplan</h1><p class="hero-desc" data-editable="hero-desc">Status ¬∑ Spieler-Reise ¬∑ Bauplan ¬∑ Retention ¬∑ Psychologie</p></header>
<nav class="nav-wrap"><div class="nav-inner"><button class="nav-btn active" data-t="status"><span class="nav-ico">üìä</span> Status</button><button class="nav-btn" data-t="phasen"><span class="nav-ico">üìÖ</span> Phasen</button><button class="nav-btn" data-t="plan"><span class="nav-ico">üî®</span> Bauplan</button><button class="nav-btn" data-t="retention"><span class="nav-ico">üß≤</span> Retention</button><button class="nav-btn" data-t="psycho"><span class="nav-ico">üß†</span> Psychologie</button><button class="nav-btn" data-t="synergien"><span class="nav-ico">üîó</span> Synergien</button></div></nav>
<div class="search-wrap"><input type="text" id="searchInput" placeholder="Suche in allen Bereichen..." oninput="handleSearch(this.value)"></div>
<div class="prog-wrap"><div class="prog-top"><h3>üìä Umsetzung</h3><span class="prog-pct" id="pPct">0%</span></div><div class="prog-bar"><div class="prog-fill" id="pFill"></div></div><div class="prog-stats"><span id="pDone">0 erledigt</span><span>¬∑</span><span id="pAll">0 Aufgaben</span></div></div>
<div id="sections"></div>
</div>
<script>
firebase.initializeApp({apiKey:"AIzaSyD9VRhfeOiCT3hgPw1rSi59CM3IZpvd-c8",authDomain:"etaria-masterplan.firebaseapp.com",projectId:"etaria-masterplan",storageBucket:"etaria-masterplan.firebasestorage.app",messagingSenderId:"846876231489",appId:"1:846876231489:web:21936113eeb569f9eac3c0"});
const auth=firebase.auth(),db=firebase.firestore();

const STATUS=[
{id:"jobs",icon:"‚öíÔ∏è",title:"Jobs",cat:"Wirtschaft",color:"a",status:"exists",desc:"3 Jobs (Bergarbeiter, Holzf√§ller, Fischer). Max Level 100, ~50h Grind pro Job. Custom Enchants ab Lv10. St√ºndliches Geld-Limit (100-250$/h je Level).",details:"Anti-Farm trackt platzierte Bl√∂cke. XP-Booster kaufbar (2x/4x/6x). Fischer hat Timing-Minigame. Schatzgl√ºck-Enchant mit 12 Items.",tags:["3 Jobs","Lv100","11 Enchants","Anti-Farm"]},
{id:"waffen",icon:"üî´",title:"Waffensystem",cat:"PvP / Kampf",color:"r",status:"exists",desc:"21 GTA-V-Style Waffen mit Custom Models. Pistolen, SMGs, Gewehre, Shotguns, Sniper, RPG, Minigun, Flammenwerfer. 3 Granaten-Typen. R√ºstungssystem (max 80% Schutz).",details:"DPS: Pistole 7.5 ‚Üí Minigun 50.0. Monster 50x Schaden. 7 Munitionstypen. Kopfschuss-System.",tags:["21 Waffen","Granaten","Custom R√ºstung","‚ö†Ô∏è Muni nur Admin"]},
{id:"crates",icon:"üé∞",title:"LuckyCrates",cat:"Loot",color:"p",status:"partial",desc:"1 Crate (Waffenkiste). Roulette + CSGO Animation. Fragment-System: Zombies droppen Fragmente (3%), 5 = 1 Key.",details:"Rarit√§t: Gew√∂hnlich (>10%) bis Mystisch (<0.2%). Minigun = 0.048%. System kann mehr.",tags:["1 Crate","Fragmente","Recycler","‚ö†Ô∏è Nur Waffen-Loot"]},
{id:"growing",icon:"üåø",title:"Drogen (Cannabis)",cat:"Wirtschaft",color:"g",status:"partial",desc:"Cannabis auf Wasserkesseln. 60 Min Wachstum (36 mit D√ºnger). Ernte ‚Üí trocknen ‚Üí verpacken ‚Üí verkaufen.",details:"2 D√ºnger-Typen. Nur 1 Pflanze. Kein Konsum, kein Risiko.",tags:["1 Pflanze","Verarbeitungskette","‚ö†Ô∏è Kein Risiko","‚ö†Ô∏è Kein Konsum"]},
{id:"clan",icon:"‚öîÔ∏è",title:"Clan-System",cat:"Social",color:"b",status:"exists",desc:"Kostenlos. 5 Mitglieder Start, erweiterbar. 5 R√§nge. Clan-Bank. Clan-Chat + Allianz-Chat.",details:"FF togglebar. DB-Felder f√ºr Upkeep existieren, NICHT aktiv.",tags:["Clan-Bank","Allianzen","‚ö†Ô∏è Kein Upkeep","‚ö†Ô∏è Keine Wars"]},
{id:"chunks",icon:"üèóÔ∏è",title:"Chunk-Claiming",cat:"Base Building",color:"c",status:"exists",desc:"Erster Claim gratis, +10% exponentiell. Gruppen, Freunde, Partikel, voller Schutz.",details:"Max Claims: 3‚Äì25 je Rang. Keine laufenden Kosten.",tags:["Exponentiell","Gruppen","‚ö†Ô∏è Keine Wartungskosten"]},
{id:"pvp",icon:"üíÄ",title:"PvP / Combat",cat:"Kampf",color:"r",status:"partial",desc:"60s Combat-Tag. Full Loot. PvP-Zonen sichtbar. Combat-Logout = Tod.",details:"Kein Kill-Reward. Kein Bounty. Kein Anreiz au√üer Griefing.",tags:["Combat-Tag","Full Loot","‚ö†Ô∏è Kein Kill-Reward","‚ö†Ô∏è Kein Bounty"]},
{id:"misc",icon:"üì±",title:"Weitere Systeme",cat:"QoL",color:"a",status:"exists",desc:"Handy-GUI, NPCs, Rucksack (6 Stufen), Home/TPA/RTP, Tutorial, Chat-Filter, 16 R√§nge, Scoreboard.",details:"6 Zombie-Typen. Alle brennen nicht bei Tag. 3% Fragment-Drop.",tags:["Handy","NPCs","Rucksack","6 Zombie-Typen","Tutorial"]}
];

const PHASES=[
{num:1,title:"Ankunft",time:"Min 0‚Äì30",goal:"Spieler versteht Etaria und hat seinen ersten Kill.",text:"Tutorial: Zombie-Kampf ‚Üí Cannabis pflanzen ‚Üí Server-Tour. Hook in 10 Min.",checks:[{t:"Tutorial fehlerfrei",k:"p1-tut"},{t:"Waffe + Muni nach Tutorial",k:"p1-gun"},{t:"Job-Auswahl erkl√§rt",k:"p1-job"},{t:"In Survival geleitet",k:"p1-rtp"},{t:"Erster Kill f√ºhlt sich gut an",k:"p1-feel"}]},
{num:2,title:"Aufbau",time:"Tag 1‚Äì3",goal:"Base claimen, Job leveln, Cannabis, erste Crate.",text:"Chunk claimen (gratis), Base bauen, Job farmen, Cannabis pflanzen, Fragmente sammeln ‚Üí Key ‚Üí Waffenkiste.",checks:[{t:"Claim-System erkl√§rt",k:"p2-claim"},{t:"Geld f√ºhlt sich fair an",k:"p2-money"},{t:"Cannabis funktioniert",k:"p2-grow"},{t:"Fragment-Grind motiviert",k:"p2-frag"},{t:"Erster sozialer Kontakt",k:"p2-social"}]},
{num:3,title:"Spezialisierung",time:"Tag 3‚Äì7",goal:"Custom Enchants, Clan, Nische finden.",text:"Job Lv10+ ‚Üí Enchants. Cannabis bringt Geld. Genug Keys. HIER passiert der Absprung.",checks:[{t:"Enchant-Shop auffindbar",k:"p3-ench"},{t:"Clan-Beitritt gef√∂rdert",k:"p3-clan"},{t:"Gruppen-Content",k:"p3-coop"},{t:"T√§glicher Login-Grund",k:"p3-daily"},{t:"N√§chstes Ziel sichtbar",k:"p3-goal"}]},
{num:4,title:"Langzeit",time:"Woche 2+",goal:"Events, Rivalit√§ten, t√§gliche Gr√ºnde.",text:"Hier stirbt der Server. Keine Events, keine Kill-Rewards, kein Bounty, keine Clan-Kriege.",checks:[{t:"Events laufen",k:"p4-events"},{t:"Kill-Rewards",k:"p4-kill"},{t:"Bounty aktiv",k:"p4-bounty"},{t:"Content-Zyklus",k:"p4-cycle"},{t:"Ranglisten sichtbar",k:"p4-rank"}]}
];

const PLAN=[
{id:"munition",icon:"üî´",title:"Munitions-Beschaffung",cat:"‚ö†Ô∏è KRITISCH ¬∑ Wirtschaft",color:"r",desc:"Muni + Reparatur NUR per Admin-Command. Waffensystem f√ºr Spieler kaputt.",impl:"Shop: Pistole 15$, Gewehr 40$, Sniper 80$/Magazin. Craftbar. NPC-Schmied.",tags:["‚ö†Ô∏è KRITISCH","Wirtschaft","Gold-Sink"],effort:"Hoch"},
{id:"killrew",icon:"üí∞",title:"Kill-Rewards",cat:"‚ö†Ô∏è KRITISCH ¬∑ PvP",color:"r",desc:"PvP ohne Anreiz = reines Griefing.",impl:"Kill: 10-25% Bargeld + Fragment-Chance. Anti-Abuse: 1x/h. Kill-Nachricht.",tags:["‚ö†Ô∏è KRITISCH","PvP","Motivation"],effort:"Mittel"},
{id:"events",icon:"üì°",title:"Automatische Events",cat:"‚ö†Ô∏è KRITISCH ¬∑ Retention",color:"b",desc:"KEINE Events. Hauptgrund f√ºr fehlende Langzeit-Bindung.",impl:"Airdrops alle 2-4h. Coords Broadcast. Zombies. PvP erlaubt. Boss 1x/Woche.",tags:["‚ö†Ô∏è KRITISCH","Retention","PvP-Hotspot"],effort:"Hoch"},
{id:"bounty",icon:"üéØ",title:"Bounty-System",cat:"PvP / Social",color:"r",desc:"Kopfgeld = Rivalit√§ten + Ziel f√ºr PvP-Spieler.",impl:"/bounty <spieler> <betrag>. Stapelt. Broadcast >1.000$. NPC am Spawn.",tags:["PvP","Gold-Sink","Stories"],effort:"Mittel"},
{id:"streak",icon:"üî•",title:"Daily Login Streak",cat:"Retention",color:"a",desc:"T√§gliche Belohnungen. Streak pausiert, resettet nicht.",impl:"Tag 1: 50$. Tag 7: 500$+Fragment. Tag 30: 5.000$+Key. Scoreboard.",tags:["Retention","Fair","Einfach"],effort:"Niedrig"},
{id:"schwarzmarkt",icon:"üï∂Ô∏è",title:"Schwarzmarkt-NPC",cat:"Wirtschaft / Retention",color:"a",desc:"Wechselndes Angebot, seltene Items, FOMO.",impl:"Rotation alle 3-4h, 4 Items aus ~30. Hohe Preise. Timer. Limitiert.",tags:["FOMO","Gold-Sink","Check-in"],effort:"Mittel"},
{id:"crafting",icon:"‚öîÔ∏è",title:"Waffen-Crafting",cat:"Progression",color:"p",desc:"Basis-Waffen craftbar. Seltene = Crate-exklusiv.",impl:"Werkbank: Pistole = 10 Eisen + 3 Redstone + 500$. Job-Materialien.",tags:["Crafting","Job-Abh√§ngigkeit"],effort:"Hoch"},
{id:"mehr-crates",icon:"üé∞",title:"Mehr Crate-Typen",cat:"Loot",color:"p",desc:"System kann mehr. R√ºstungs-, Vorrats-, Kosmetik-Kiste.",impl:"Eigene Fragment-Typen pro Crate von verschiedenen Quellen.",tags:["System existiert","Vielfalt"],effort:"Niedrig"},
{id:"clanwar",icon:"‚öîÔ∏è",title:"Clan-Kriege",cat:"Clan / PvP",color:"b",desc:"Clans brauchen einen Zweck. Wars = Rivalit√§t.",impl:"/clan war ‚Äì Kill-Score 3-7 Tage. Gewinner bekommt aus beiden Banks.",tags:["Clan-Content","Rivalit√§t"],effort:"Hoch"},
{id:"upkeep",icon:"üèöÔ∏è",title:"Claim-Wartung + Upkeep",cat:"Wirtschaft",color:"g",desc:"Claims + Clan kosten nichts. DB existiert. Aktivieren = Gold-Sink.",impl:"Claim: 5-20$/Tag. Clan: 50$ √ó Mitglieder. DB existiert bereits.",tags:["DB existiert","Verlustaversion"],effort:"Niedrig"},
{id:"konsum",icon:"üíä",title:"Drogen-Konsum + Pflanzen",cat:"Content",color:"g",desc:"Kein Konsum. Neue Pflanzen + PvP-Buffs.",impl:"Cannabis: Speed+St√§rke 60s. Meth: Haste III. Pilze: Nightvision+Jump.",tags:["Neue Pflanzen","PvP-Buffs"],effort:"Mittel"},
{id:"ruf",icon:"‚≠ê",title:"Ruf-System",cat:"Progression",color:"c",desc:"Kein Weg sich abzuheben. Ruf ‚Üí Status + Vorteile.",impl:"+5/Kill, +1/Handel. Stufen: Unbekannt‚ÜíLegend√§r. Titel, Rabatte.",tags:["Status","Identit√§t"],effort:"Mittel"},
{id:"handelssteuer",icon:"üí∞",title:"Handelssteuer",cat:"Clan-Wirtschaft",color:"g",desc:"% von Handel ‚Üí Clan-Bank. H√§ndler st√§rken Clan.",impl:"5-10% auf /pay ‚Üí Clan-Bank. Ohne Clan = Gold-Sink.",tags:["Clan-Benefit","Gold-Sink"],effort:"Niedrig"}
];

const RETENTION=[
{num:1,title:"Die ersten 30 Sekunden entscheiden",color:"r",text:"Spieler entscheidet in unter 1 Min ob er bleibt. Spawn muss krachen.",action:"‚Üí Spawn √ºberarbeiten. NPC: 'Willkommen in der Endzeit. Schnapp dir eine Waffe.'"},
{num:2,title:"Vermeide den Tag-3-Tod",color:"a",text:"Meisten h√∂ren Tag 2-5 auf. Hier braucht es den n√§chsten Hook.",action:"‚Üí Ab Tag 3: Enchants, Airdrop, Clan-Einladung, Schwarzmarkt."},
{num:3,title:"Spieler halten Spieler",color:"b",text:"#1 Retention-Grund = andere Spieler. Clan = 3x Retention.",action:"‚Üí Solo begrenzen. Clan f√∂rdern. Gruppen-Events."},
{num:4,title:"Mehrere Login-Gr√ºnde/Tag",color:"a",text:"Ein Daily reicht nicht. Morgens Daily, Mittags Schwarzmarkt, Abends Event.",action:"‚Üí Streak + Schwarzmarkt + Airdrop + Event = 3-4 Gr√ºnde."},
{num:5,title:"Verluste motivieren st√§rker",color:"r",text:"Menschen k√§mpfen h√§rter um Bestehendes. Nichts geht verloren auf Etaria.",action:"‚Üí Claim-Wartung, Clan-Upkeep, zeitlich begrenzte Titel."},
{num:6,title:"Sichtbarer Fortschritt",color:"g",text:"Spieler m√ºssen sehen wie weit sie sind. Job-Level allein reicht nicht.",action:"‚Üí Scoreboard: Job, Streak, Ruf, Clan-Rang."},
{num:7,title:"Vorhersehbarkeit = Feind",color:"p",text:"Alles vorhersehbar = langweilig. Mehr Zufall = mehr Sucht.",action:"‚Üí Cannabis-Events. Zombie-Loot variieren. Flaschenpost."},
{num:8,title:"Geschichten erz√§hlen sich selbst",color:"b",text:"Beste Momente wenn Systeme aufeinandertreffen. Das erz√§hlen Spieler weiter.",action:"‚Üí Bounty + Airdrops + Clan-Wars = emergente Stories."},
{num:9,title:"Onboarding nie aufh√∂ren",color:"c",text:"Neue Spieler d√ºrfen nicht verloren sein. Gap nicht zu gro√ü.",action:"‚Üí Starter-Kit. 7 Tage Schutz. Catch-up-Mechanik."},
{num:10,title:"Content-Kalender",color:"a",text:"Fester Rhythmus. Spieler m√ºssen wissen wann was passiert.",action:"‚Üí Mo: Boss. Mi: PvP. Fr: Doppel-XP. So: Airdrop-Marathon."}
];

const PSYCHO=[
{icon:"‚è≥",title:"Sunk-Cost-Effekt",color:"a",problem:"Alles in Tagen erreichbar. Lv100 = ~50h, Schluss. Keine Langzeit-Ziele.",fix:"Prestige-System. Crafting √ºber Wochen. Ruf √ºber Monate. Clan-Projekte."},
{icon:"üë•",title:"Soziale Bindung",color:"b",problem:"Clans = nur Chat. Kein Teamwork-Content.",fix:"Clan-Wars, Upkeep, Handelssteuer, Boss-Events f√ºr 3+."},
{icon:"üìâ",title:"Verlustaversion",color:"r",problem:"Nichts kostet. Upkeep deaktiviert. Offline = null Konsequenzen.",fix:"Wartung + Upkeep aktivieren (DB existiert!). Streak-Verlust."},
{icon:"üé∞",title:"Variable Belohnung",color:"p",problem:"Crates = Zufall, Rest = fix. Alles vorhersehbar nach Tag 3.",fix:"Zombie-Loot variieren. Cannabis-Events. Fischer: Flaschenpost."},
{icon:"üëë",title:"Identit√§t & Status",color:"c",problem:"16 R√§nge nur Premium. Keine Ranglisten. Austauschbar.",fix:"Ruf-Titel. Kill-Rangliste. Achievements. Monatliche Awards."}
];

const SYNERGIES=[
{icon:"‚öíÔ∏è‚Üí‚öîÔ∏è",title:"Jobs + Waffen-Crafting",color:"a",text:"Bergarbeiter Erze, Holzf√§ller Griffe, Fischer Materialien ‚Üí erzwingt Handel."},
{icon:"üî´+üí∞",title:"Munition + Kill-Rewards",color:"r",text:"Muni kostet. Kills bringen Geld. Jeder Fight = Kosten-Nutzen."},
{icon:"üåø+üíä+üï∂Ô∏è",title:"Cannabis + Konsum + Schwarzmarkt",color:"g",text:"Produzieren ‚Üí PvP-Buffs oder verkaufen. Schwarzmarkt = seltene D√ºnger."},
{icon:"‚öîÔ∏è+üè¥+üéØ",title:"Clan-Wars + Bounty + Events",color:"b",text:"Clans k√§mpfen ‚Üí Kopfgeld ‚Üí S√∂ldner ‚Üí Airdrop-Schlacht."},
{icon:"üî•+üï∂Ô∏è+üì°",title:"Streak + Schwarzmarkt + Events",color:"a",text:"3 Login-Gr√ºnde: Daily, Schwarzmarkt, Event. Verschiedene Uhrzeiten."},
{icon:"üèóÔ∏è+üíÄ+‚õèÔ∏è",title:"Wartung + Full Loot + Knappheit",color:"r",text:"Claim-Kosten + Loot-Drop + Muni-Kosten = echte Konsequenzen."}
];

// ========== STATE ==========
let currentUser=null,isAdmin=false,editMode=false,activeTab='status',searchQuery='';
let S={checks:{},prios:{},impls:{}};
let editedContent={};
const $=id=>document.getElementById(id), root=$('sections');

// ========== AUTH ==========
function switchLoginTab(tab){
  document.querySelectorAll('.login-tab').forEach((t,i)=>{t.classList.toggle('active',(tab==='admin'&&i===0)||(tab==='guest'&&i===1))});
  $('loginForm').style.display=tab==='admin'?'block':'none';
  $('guestForm').style.display=tab==='guest'?'block':'none';
  $('guestLink').style.display=tab==='guest'?'none':'block';
}

async function doLogin(){
  const email=$('loginUser').value.trim(),pass=$('loginPass').value,btn=$('loginBtn');
  btn.disabled=true;btn.innerHTML='<span class="spinner"></span>';$('loginError').textContent='';
  try{await auth.signInWithEmailAndPassword(email,pass)}
  catch(e){
    let msg='‚ùå Anmeldung fehlgeschlagen';
    if(e.code==='auth/invalid-credential'||e.code==='auth/wrong-password'||e.code==='auth/user-not-found')msg='‚ùå Falsche E-Mail oder Passwort';
    else if(e.code==='auth/invalid-email')msg='‚ùå Ung√ºltige E-Mail';
    else if(e.code==='auth/too-many-requests')msg='‚ùå Zu viele Versuche';
    $('loginError').textContent=msg;btn.disabled=false;btn.textContent='Anmelden';
  }
}

function doGuest(){
  currentUser=$('guestName').value.trim()||'Besucher';isAdmin=false;enterApp();
}

function doLogout(){
  auth.signOut();currentUser=null;isAdmin=false;editMode=false;
  document.body.classList.remove('admin-mode');
  $('app').style.display='none';$('topbar').style.display='none';
  $('editBar').classList.remove('show');$('loginOverlay').classList.remove('hidden');
  $('loginUser').value='';$('loginPass').value='';$('loginError').textContent='';
  $('loginBtn').disabled=false;$('loginBtn').textContent='Anmelden';
}

auth.onAuthStateChanged(user=>{
  if(user){currentUser=user.email.split('@')[0];isAdmin=true;enterApp()}
});

function enterApp(){
  $('loginOverlay').classList.add('hidden');$('app').style.display='block';$('topbar').style.display='flex';
  const b=$('roleBadge');b.textContent=isAdmin?'ADMIN':'BESUCHER';b.className='topbar-badge '+(isAdmin?'badge-admin':'badge-viewer');
  $('userDisplay').innerHTML='Hallo, <strong>'+currentUser+'</strong>';
  $('editToggle').style.display=isAdmin?'inline-flex':'none';
  loadFromFirestore();
}

// ========== FIRESTORE ==========
async function loadFromFirestore(){
  $('syncStatus').innerHTML='<span class="spinner"></span>';
  try{
    const sd=await db.collection('masterplan').doc('state').get();
    if(sd.exists)S={checks:{},prios:{},impls:{},...sd.data()};
    const ed=await db.collection('masterplan').doc('edits').get();
    if(ed.exists)editedContent=ed.data()||{};
    $('syncStatus').innerHTML='<span class="online-dot"></span>';
    renderAll();
  }catch(e){
    console.error('Load error:',e);
    $('syncStatus').innerHTML='<span style="color:var(--red);font-size:.6rem">‚ö†Ô∏è</span>';
    renderAll();
  }
}

async function saveState(){try{await db.collection('masterplan').doc('state').set(S)}catch(e){console.error(e)}}
async function saveEditsToDB(){try{await db.collection('masterplan').doc('edits').set(editedContent)}catch(e){throw e}}

// Realtime listeners
db.collection('masterplan').doc('state').onSnapshot(doc=>{if(doc.exists){S={checks:{},prios:{},impls:{},...doc.data()};renderAll()}});
db.collection('masterplan').doc('edits').onSnapshot(doc=>{if(doc.exists){editedContent=doc.data()||{};applyEdits()}});

// ========== EDIT ==========
function toggleEditMode(){
  if(!isAdmin)return;editMode=!editMode;
  document.body.classList.toggle('admin-mode',editMode);
  $('editBar').classList.toggle('show',editMode);
  $('editToggle').textContent=editMode?'üëÅÔ∏è Vorschau':'‚úèÔ∏è Bearbeiten';
  if(editMode)enableEdit();else disableEdit();
}
function enableEdit(){document.querySelectorAll('[data-editable]').forEach(el=>{el.contentEditable=true})}
function disableEdit(){document.querySelectorAll('[data-editable]').forEach(el=>{el.contentEditable=false})}

async function saveEdits(){
  document.querySelectorAll('[data-editable]').forEach(el=>{editedContent[el.dataset.editable]=el.innerHTML});
  try{await saveEditsToDB();showToast('‚úì Gespeichert! Alle sehen die √Ñnderungen.')}
  catch(e){showToast('‚ùå Speichern fehlgeschlagen!',true)}
}
function cancelEdits(){
  editMode=false;document.body.classList.remove('admin-mode');
  $('editBar').classList.remove('show');$('editToggle').textContent='‚úèÔ∏è Bearbeiten';
  applyEdits();disableEdit();
}
function applyEdits(){Object.entries(editedContent).forEach(([k,v])=>{const el=document.querySelector('[data-editable="'+k+'"]');if(el&&!editMode)el.innerHTML=v})}
function showToast(msg,err){const t=$('toast');t.textContent=msg;t.className='toast show'+(err?' error':'');setTimeout(()=>t.className='toast',2500)}

// ========== SEARCH ==========
function handleSearch(q){searchQuery=q.toLowerCase().trim();renderAll()}
function matchS(texts){if(!searchQuery)return true;return texts.some(t=>t&&t.toLowerCase().includes(searchQuery))}

// ========== RENDER ==========
function badge(s){if(s==='exists')return'<span class="badge-live">‚úì LIVE</span>';if(s==='partial')return'<span class="badge-partial">‚óê TEILWEISE</span>';return'<span class="badge-missing">‚úó FEHLT</span>'}

function renderAll(){
  root.innerHTML=[renderStatus(),renderPhases(),renderPlan(),renderRetention(),renderPsycho(),renderSynergies()].join('');
  document.querySelectorAll('.sec').forEach(s=>s.classList.remove('vis'));
  const a=document.querySelector('.sec[data-s="'+activeTab+'"]');if(a)a.classList.add('vis');
  bind();updateProg();applyEdits();if(editMode)enableEdit();
}

function renderStatus(){
  const live=STATUS.filter(s=>s.status==='exists').length,partial=STATUS.filter(s=>s.status==='partial').length,crit=STATUS.filter(s=>s.tags.some(t=>t.startsWith('‚ö†Ô∏è'))).length;
  const f=STATUS.filter(s=>matchS([s.title,s.desc,s.details,s.cat,...s.tags]));
  return '<div class="sec" data-s="status"><div class="sec-head"><div class="sec-ico i-g">üìä</div><h2>Server-Status</h2><span class="sec-cnt">16 Plugins ¬∑ 8 Systeme</span></div><p class="sec-desc" data-editable="status-desc">Was auf Etaria.net tats√§chlich l√§uft.</p><div class="quick-stats"><div class="qstat"><div class="qstat-val c-g">'+live+'</div><div class="qstat-label">Live</div></div><div class="qstat"><div class="qstat-val c-a">'+partial+'</div><div class="qstat-label">Teilweise</div></div><div class="qstat"><div class="qstat-val c-r">'+crit+'</div><div class="qstat-label">Warnungen</div></div><div class="qstat"><div class="qstat-val c-c">'+STATUS.length+'</div><div class="qstat-label">Gesamt</div></div></div><div class="grid">'+f.map(s=>'<div class="card"><div class="accent-bar bg-'+s.color+'"></div><div class="card-head"><span class="card-emoji">'+s.icon+'</span><div class="card-meta"><span class="card-cat">'+s.cat+'</span><h4>'+s.title+' '+badge(s.status)+'</h4></div></div><p data-editable="status-'+s.id+'-desc">'+s.desc+'</p><div class="card-detail" data-editable="status-'+s.id+'-detail">'+s.details+'</div><div class="tags">'+s.tags.map(t=>'<span class="pill '+(t.startsWith('‚ö†Ô∏è')?'t-r':'t-'+s.color)+'">'+t+'</span>').join('')+'</div></div>').join('')+'</div></div>';
}

function renderPhases(){
  return '<div class="sec" data-s="phasen"><div class="sec-head"><div class="sec-ico i-b">üìÖ</div><h2>Spieler-Reise</h2><span class="sec-cnt">4 Phasen</span></div><p class="sec-desc" data-editable="phases-desc">Wie ein neuer Spieler Etaria.net erlebt.</p><div class="tl">'+PHASES.map(ph=>{
    const done=ph.checks.every(c=>S.checks[c.k]);
    return '<div class="ph '+(done?'done':'')+'"><div class="dot">'+(done?'‚úì':ph.num)+'</div><div class="card"><div class="ptop"><h4>'+ph.title+'</h4><span class="time-badge">'+ph.time+'</span></div><div class="goal-text" data-editable="phase-'+ph.num+'-goal">'+ph.goal+'</div><p data-editable="phase-'+ph.num+'-text">'+ph.text+'</p><div class="cklist">'+ph.checks.map(c=>{const on=S.checks[c.k];return '<label class="ck '+(on?'on':'')+'" data-k="'+c.k+'"><span class="box">'+(on?'‚úì':'')+'</span>'+c.t+'</label>'}).join('')+'</div></div></div>'}).join('')+'</div></div>';
}

function renderPlan(){
  const f=PLAN.filter(x=>matchS([x.title,x.desc,x.impl,x.cat,...x.tags]));
  const dc=Object.values(S.impls).filter(Boolean).length,hc=Object.values(S.prios).filter(v=>v==='h').length;
  return '<div class="sec" data-s="plan"><div class="sec-head"><div class="sec-ico i-a">üî®</div><h2>Bauplan</h2><span class="sec-cnt">'+PLAN.length+' Features</span></div><p class="sec-desc" data-editable="plan-desc">Was gebaut werden muss.</p><div class="quick-stats"><div class="qstat"><div class="qstat-val c-g">'+dc+'</div><div class="qstat-label">Umgesetzt</div></div><div class="qstat"><div class="qstat-val c-r">'+hc+'</div><div class="qstat-label">Hohe Prio</div></div><div class="qstat"><div class="qstat-val c-a">'+PLAN.filter(x=>x.effort==='Hoch').length+'</div><div class="qstat-label">Hoher Aufwand</div></div><div class="qstat"><div class="qstat-val c-c">'+(PLAN.length-dc)+'</div><div class="qstat-label">Offen</div></div></div><div class="grid">'+f.map(x=>{const p=S.prios[x.id]||'',d=S.impls[x.id];return '<div class="card" style="'+(d?'opacity:.55;':'')+'"><div class="accent-bar bg-'+x.color+'"></div><div class="card-head"><span class="card-emoji">'+x.icon+'</span><div class="card-meta"><span class="card-cat">'+x.cat+' ¬∑ '+x.effort+'</span><h4>'+x.title+'</h4></div></div><p data-editable="plan-'+x.id+'-desc">'+x.desc+'</p><div class="card-detail" data-editable="plan-'+x.id+'-impl"><strong>Umsetzung:</strong> '+x.impl+'</div><div class="tags">'+x.tags.map(t=>'<span class="pill '+(t.startsWith('‚ö†Ô∏è')?'t-r':'t-'+x.color)+'">'+t+'</span>').join('')+'</div><div class="status-row"><div class="prio-btns"><button class="pbtn '+(p==='h'?'s-h':'')+'" data-id="'+x.id+'" data-p="h">Hoch</button><button class="pbtn '+(p==='m'?'s-m':'')+'" data-id="'+x.id+'" data-p="m">Mittel</button><button class="pbtn '+(p==='l'?'s-l':'')+'" data-id="'+x.id+'" data-p="l">Niedrig</button></div><label class="chk '+(d?'on':'')+'" data-id="'+x.id+'"><span class="box">'+(d?'‚úì':'')+'</span>Umgesetzt</label></div></div>'}).join('')+'</div></div>';
}

function renderRetention(){
  const f=RETENTION.filter(r=>matchS([r.title,r.text,r.action]));
  return '<div class="sec" data-s="retention"><div class="sec-head"><div class="sec-ico i-a">üß≤</div><h2>Retention-Tipps</h2><span class="sec-cnt">'+RETENTION.length+' Strategien</span></div><p class="sec-desc" data-editable="retention-desc">Konkrete Tipps wie ihr Spieler haltet.</p><div class="grid">'+f.map(r=>'<div class="tip"><div class="tip-head"><span class="tip-num">'+r.num+'</span><span class="c-'+r.color+'" data-editable="ret-'+r.num+'-title">'+r.title+'</span></div><p data-editable="ret-'+r.num+'-text">'+r.text+'</p><div class="tip-action" data-editable="ret-'+r.num+'-action">'+r.action+'</div></div>').join('')+'</div></div>';
}

function renderPsycho(){
  return '<div class="sec" data-s="psycho"><div class="sec-head"><div class="sec-ico i-p">üß†</div><h2>Spielerpsychologie</h2><span class="sec-cnt">5 Prinzipien</span></div><p class="sec-desc" data-editable="psycho-desc">Warum Spieler bleiben oder gehen.</p><div class="grid">'+PSYCHO.map((p,i)=>'<div class="card psycho-card"><div class="accent-bar bg-'+p.color+'"></div><div class="card-head"><span class="card-emoji">'+p.icon+'</span><h4 class="c-'+p.color+'">'+p.title+'</h4></div><p><span class="problem-label">Problem:</span> <span data-editable="psy-'+i+'-problem">'+p.problem+'</span></p><span class="fix-label">L√∂sung:</span><div class="card-detail" data-editable="psy-'+i+'-fix">'+p.fix+'</div></div>').join('')+'</div></div>';
}

function renderSynergies(){
  return '<div class="sec" data-s="synergien"><div class="sec-head"><div class="sec-ico i-r">üîó</div><h2>Synergien</h2><span class="sec-cnt">So greift alles ineinander</span></div><p class="sec-desc" data-editable="syn-desc">Jedes Feature verst√§rkt die anderen.</p><div class="grid grid-sm">'+SYNERGIES.map((s,i)=>'<div class="syn"><div class="syn-title"><span class="c-'+s.color+'">'+s.icon+'</span> <span data-editable="syn-'+i+'-title">'+s.title+'</span></div><p data-editable="syn-'+i+'-text">'+s.text+'</p></div>').join('')+'</div></div>';
}

// ========== BIND ==========
function bind(){
  root.querySelectorAll('.ck').forEach(el=>{el.onclick=()=>{if(!isAdmin)return;S.checks[el.dataset.k]=!S.checks[el.dataset.k];saveState();renderAll()}});
  root.querySelectorAll('.pbtn').forEach(b=>{b.onclick=()=>{if(!isAdmin)return;const id=b.dataset.id,p=b.dataset.p;S.prios[id]=S.prios[id]===p?'':p;saveState();renderAll()}});
  root.querySelectorAll('.chk').forEach(el=>{el.onclick=()=>{if(!isAdmin)return;S.impls[el.dataset.id]=!S.impls[el.dataset.id];saveState();renderAll()}});
}

function updateProg(){
  const tp=PHASES.reduce((s,p)=>s+p.checks.length,0),tf=PLAN.length,total=tp+tf;
  const dp=Object.values(S.checks).filter(Boolean).length,df=Object.values(S.impls).filter(Boolean).length,done=dp+df;
  const pct=total?Math.round(done/total*100):0;
  $('pPct').textContent=pct+'%';$('pFill').style.width=pct+'%';
  $('pDone').textContent=done+' erledigt';$('pAll').textContent=total+' Aufgaben';
}

// ========== NAV ==========
document.querySelectorAll('.nav-btn').forEach(btn=>{btn.onclick=()=>{
  activeTab=btn.dataset.t;
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active');
  document.querySelectorAll('.sec').forEach(s=>s.classList.remove('vis'));
  const sec=document.querySelector('.sec[data-s="'+activeTab+'"]');if(sec)sec.classList.add('vis');
}});

$('loginPass').onkeydown=e=>{if(e.key==='Enter')doLogin()};
$('guestName').onkeydown=e=>{if(e.key==='Enter')doGuest()};
renderAll();
</script>
</body>
</html>
